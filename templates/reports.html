{% extends "base.html" %}
{% block content %}
<h3 class="mb-3">Reports</h3>
<form method="get" class="card p-3 mb-3">
  <div class="row g-2">
    <div class="col-md-3"><label class="form-label">Start</label><input type="date" name="start" value="{{ start }}" class="form-control"></div>
    <div class="col-md-3"><label class="form-label">End</label><input type="date" name="end" value="{{ end }}" class="form-control"></div>
    <div class="col-md-3">
      <label class="form-label">Category</label>
      <select name="category" class="form-select">
        <option value="all" {{ 'selected' if sel_cat=='all' }}>All</option>
        {% for c in categories %}
          <option value="{{ c.name }}" {{ 'selected' if sel_cat==c.name }}>{{ c.name }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-3 d-flex align-items-end gap-2">
      <button class="btn btn-primary">Filter</button>
      <a class="btn btn-outline-secondary" href="{{ url_for('reports.export', fmt='csv', start=start, end=end, category=sel_cat) }}">Export CSV</a>
      <a class="btn btn-outline-secondary" href="{{ url_for('reports.export', fmt='pdf', start=start, end=end, category=sel_cat) }}">Export PDF</a>
    </div>
  </div>
</form>

<div class="card">
  <div class="table-responsive">
    <table class="table table-hover mb-0">
      <thead><tr><th>Date</th><th>Type</th><th>Category</th><th class="text-end">Amount</th><th>Description</th></tr></thead>
      <tbody>
        {% for r in rows %}
          <tr>
            <td>{{ r.date }}</td>
            <td class="text-capitalize">{{ r.type }}</td>
            <td>{{ r.category.name if r.category else '-' }}</td>
            <td class="text-end">{{ '%.2f'|format(r.amount) }} â‚¬</td>
            <td>{{ r.description or '' }}</td>
          </tr>
        {% else %}
          <tr><td colspan="5" class="text-center py-4">No records for the selected filters.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
