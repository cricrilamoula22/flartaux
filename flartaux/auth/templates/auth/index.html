<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - Mobile Market</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
	<link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css')}}">
</head>
<!--<div class="blue-div">-->
    {% include 'parsel/header.html' %}

                {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                 
    {% for message in messages %}
                <div style = "background-color: red text-color: yellow" class="alert alert-success alert-warning alert-dismissible fade show" role="error">
                    <button type="button" class="close" data-dismiss="alert" aria-label="close">
                        <span aria-hidden="true">x</span>
                    </button>
                {{message}}
                </div>
                {% endfor %}
     
                {% endif %}
                {% endwith %}
	
{% block content %}
<body>
  <div class="container" style="width:100%; height:100%; left:0;top:0;">
    <div class="table-row">
     <div class="table-cell">
	        <div class="card-body">
		
			<form method="POST">
				{{ form.csrf_token}}  
				<div class="form-group">
				<label for="email">Commune:</label>
				{{ form.commune(class="form-control") }}
				</div>
				<div class="form-group">
				<label for="email">section:</label>
				{{ form.section(class="form-control")}}
				</div>
				<input type="submit" value="sldmjklkqkjmlqjmfjkmqkjeFiltrer les parcelles" class="btn btn-success" btn-lg>
  </form>


                <h6>En cas de parcelle manquante : <button type="button"  class="btn btn-success float-right"
                data-toggle="modal" data-target="#mymodal">Ajouter une parcelle manquante</button> </h2>
                {% with messages = get_flashed_messages() %}
                {% if messages %}
                 
    {% for message in messages %}
                <div class="alert alert-success alert-dismissable" role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="close">
                        <span aria-hidden="true">x</span>
                    </button>
                {{message}}
                </div>
                {% endfor %}
     
                {% endif %}
                {% endwith %}
  
                <table class="table table-hover table-striped">
                   {% for TCadastre in t_cadastre %}
     <!-- Modal Edit Employee-->
     <div id="modaledit{{TCadastre.idt_cadastre}}" class="modal fade" role="dialog">
        <div class="modal-dialog">
        <div class="modal-content">
       <div class="modal-header"><h4 class="modal-title">Update Information</h4></div>
        <div class="modal-body">
        <form action="{{url_for('zut.update')}}" method="POST">
         <div class="form-group">
          <label>Name:</label>
          <input type="hidden"  name="idt_cadastre" value="{{TCadastre.idt_cadastre}}">
          <input type="text" class="form-control" name="name" value="{{TCadastre.idsuf}}">
         </div>
         <div class="form-group">
          <button class="btn btn-primary" type="submit">Update</button>
         </div>
        </form>
        </div>
        <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
      </div>
     </div> 
     {% endfor %}
    </table>
   </div>
  
  <!-- Modal Add Employee-->
  <div id="mymodal" class="modal fade" role="dialog">
      <div class="modal-dialog">
     <div class="modal-content">
    <div class="modal-header"><h4 class="modal-title">Ajouter une parcelle manquante</h4></div>
    <div class="modal-body">
     <form action="{{url_for('zut.insert')}}" method="POST">
      <div class="form-group">
       <label>idsuf:</label>
       <input type="text" class="form-control" name="idsuf" required="1">
      </div>
	  <div class="form-group">
       <label>ccosec:</label>
       <input type="text" class="form-control" name="ccosec" required="1">
      </div>
	  <div class="form-group">
       <label>idcom:</label>
       <input type="text" class="form-control" name="idcom" required="1">
      </div>
      <div class="form-group">
      <button class="btn btn-primary" type="submit">Ajouter une parcelle manquante</button>
      </div>
     </form>
    </div>
    <div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-dismiss="modal">Abandonner l'ajout</button>
    </div>
   </div>
   </div>
  </div>


     <div class="form-inline">
          {% for parcelle in parcelles %}
<form action="/pay" name="idsuf" method="post">
            <input type="hidden" name="parcelle_idsuf" value="{{parcelle['idsuf']}}">

            <button type="submit" class="pay-button">{{ parcelle.idsuf }}</button>
	

        </form>	
          {% endfor %}
        </div>
        </div>		

<script>
commune_select = document.getElementById('commune');
section_select = document.getElementById('section');
parcelle_select = document.getElementById('parcelle');
 
commune_select.onchange = function(){
 history.pushState({}, null, '/bof');
 commune = commune_select.value;
 <!-- alert(commune); --> 
 fetch('section/' + commune).then(function(response){
  response.json().then(function(data) {
   optionHTML = '';
   for (section of data.sectioncommune) {
    optionHTML += '<option value="' + section.ccosec +'">' + section.ccosec + '</option>'
   }
   section_select.innerHTML = optionHTML;
  });
 });
}
section_select.onchange = function(){
 parcelle = section_select.value; 
 fetch('parcelle/' + parcelle).then(function(response){
  response.json().then(function(data) {
   optionHTML = '';
   for (parcelle_rs of data.parcellelist) {
    optionHTML += '<option value="' + parcelle_rs.ccosec +'">' + parcelle_rs.ccosec + '</option>'
   }
   parcelle_select.innerHTML = optionHTML;
  });
 });
}
</script>
				
				
{% endblock %}
{% extends "parsel/layout.html"%}
{%block body%}

      <div class="table-cell">	  
   
            <table id="example" class= "table table-hover table-bordered">

                <thead>
                    <tr class="bg-dark text-white">
                        <th scope="col">Course Name</th>
                        <th scope="col">Action</th>
					</tr>
                </thead>
                <tbody>
                    {%for TParceldem in t_parceldem%}
                    <tr>
                        <!-- data.index is used so that table has S.no. even when some
                        id get deleted from the table-->

                        <td width="3900" >{{TParceldem.par_idsuf}}</td>
                        <td width="150" >
                            <!-- to get the value for button we need real ID not index -->

                            <a href="/delete/{{TParceldem[0]}}" class="btn btn-danger btn-sm ">Delete</a>
                        </td>
					</tr>
                    {%endfor%}
                </tbody>
            </table>
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
      </div>
    </div>
  </div>
  </body>

{%endblock%}
<!--</div>-->
</html>
